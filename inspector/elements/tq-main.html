<!-- Copyright 2016 The Fuchsia Authors. All rights reserved. -->

<dom-module id="tq-json">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }
    </style>

    <paper-material elevation="1">
      <pre>{{json_string}}</pre>
    </paper-material>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'tq-json',
        properties: {
          json: {
            type: Object,
            notify: 'true',
            observer: '_jsonChanged',
          },
        },
        _jsonChanged: function() {
          this.json_string = JSON.stringify(this.json, null, ' ');
        }
      });
    })();
  </script>
</dom-module>

<dom-module id="tq-main">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        padding: 48px 62px;
      }
    </style>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'tq-main',
        properties: {
          json: {
            type: Object,
            notify: 'true',
            observer: '_jsonChanged',
          },
          raw: {
            type: Boolean,
            observer: '_jsonChanged',
          }
        },
        _currentChild: null,
        _jsonChanged: function() {
          // What's the name of the element we should use to display this type of data?
          let elementName = this.raw ? 'tq-json' :
              inspectorElements[this.json?this.json.type:null] || 'tq-json';
          if (this._currentChild) {
            if (this._currentChild.localName != elementName) {
              // The wrong kind, remove it.
              this.removeChild(this._currentChild);
              this._currentChild = null;
            }
          }
          if (!this._currentChild) {
            // Add the right kind of element.
            this._currentChild = document.createElement(elementName);
            this.appendChild(this._currentChild);
          }
          this._currentChild.json = this.json;
        }
      });
    })();
  </script>
</dom-module>
